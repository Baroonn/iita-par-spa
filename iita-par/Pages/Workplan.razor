@page "/workplan"
@using Microsoft.AspNetCore.Authorization;
@using iita_par.Authentication

@inherits AuthorizePage

@inject HttpClient _httpClient;

<div class="header">
    <h1>ADEMOLA Patrick's Workplan</h1>
    <p>NRS Professional</p>
    <br>

    <p class="contact-info">📧 Contact IITA DIMU - ITSA for help with software-technical issues with the Workplan application.</p>
</div>
<div class="actions">
    <p>Add your workplan: </p>
    <div class="add-workplan">
        <a class="button" href="/add-new-record">Add new records to your Workplan 2025</a>
        <a class="button" href="/import-workplan">Import new workplans from Excel (.xls) file</a>
    </div>

</div>
<div class="workplan-section par-card">
    <div class="objectives">
        <h2>List of Workplan Objectives - 2024</h2>
        @if(objectives != null)
        {
            int count = 1;
            @foreach(var item in objectives)
            {
                <div class="objective">
                    <p><strong>@count</strong> @item.Objective </p>
                    <a class="button" @onclick=@(() => NavigateToDetails(item.Id))>Details</a>
                </div>
                count++;
            }
        }
        else
        {
            <p>Loading Objectives...</p>
        }
        @* 
        <div class="objective">
            <p><strong>2</strong> Enhance the efficiency and effectiveness of the IT department.</p>
            <a class="button" href="/workplan-details">Details</a>
        </div>
        <div class="objective">
            <p><strong>3</strong> Enhance Employee Engagement and Satisfaction.</p>
            <a class="button" href="/workplan-details">Details</a>
        </div> *@
    </div>
    <div class="approval-section">
        <div class="year-selector">
            <label for="year">Pick a year:</label>
            <select @bind=selectedYear id="year">
                <option value="2024" selected>2024</option>
                <!-- Add other years as needed -->
            </select>
        </div>
        @if (!logs.Any())
        {
            <div class="approval-status">
                <p>💡 Your Workplan is yet to be submitted for approval.</p>
                <textarea class="text-area" placeholder="Leave a comment:" @bind=comment></textarea>
                <br>
                <button class="submit-button" @onclick="Submit">Submit</button>
            </div>
        }
        else
        {
            <div class="action-logs">
                <h2>💡 Workplan Action Logs</h2>

                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Action</th>
                            <th>Details</th>
                            <th>Comment</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in logs)
                        {
                            <tr>
                                <td>@item.CreatedDate</td>
                                <td>@item.Action</td>
                                <td>Workplan @item.Action by Ademola Patrick</td>
                                <td>@item.Comment</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
    </div>
</div>